{
  "hash": "312516199edd1a7658def61627545642",
  "result": {
    "markdown": "---\ntitle: \"In-class Exercise 3\"\ndescription: \"Kernel Density Estimation\"\nexecute: \n  warning: false\n  eval: true\n  echo: true\n  freeze: true\n# date: \"2024-02-19\"\ndate: 01/22/2024\ndate-format: \"D MMM, YYYY\" \nauthor: \n  - Wan Shen\nsidebar: false\ntitle-block-banner: true\ncategories:\n  - In-Class Exercise\ntitle-block-categories: false\n---\n\n\n# 1.0 Getting Started\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(maptools, sf, raster, spatstat, tmap, tidyverse)\n```\n:::\n\n\n# 2.0 Spatial Data Wrangling\n\n## 2.1 Importing the spatial data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchildcare_sf <- st_read(\"../../data/geospatial/ChildCareServices.geojson\") %>% st_transform(crs = 3414)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `ChildCareServices' from data source \n  `C:\\wanshen123\\IS415-GAA\\data\\geospatial\\ChildCareServices.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 1925 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sf <- st_read(\"../../data/geospatial\", layer=\"MP14_SUBZONE_WEB_PL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\wanshen123\\IS415-GAA\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(mpsz_sf)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex03_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## 2.2 Creating coastal outline\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsg_sf <- mpsz_sf %>%\n  st_union()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sg_sf)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex03_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n# 3.0 Geospatial Data Wrangling\n\n## 3.1 Creating ppp objects: sf method\n\n::: callout-note\nFrom sf to ppp directly.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchildcare_sp <- as_Spatial(childcare_sf)\nglimpse(childcare_sp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nFormal class 'SpatialPointsDataFrame' [package \"sp\"] with 5 slots\n  ..@ data       :'data.frame':\t1925 obs. of  2 variables:\n  .. ..$ Name       : chr [1:1925] \"kml_1\" \"kml_2\" \"kml_3\" \"kml_4\" ...\n  .. ..$ Description: chr [1:1925] \"<center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\\\"#E3E3F3\\\"> <th>ADD\"| __truncated__ \"<center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\\\"#E3E3F3\\\"> <th>ADD\"| __truncated__ \"<center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\\\"#E3E3F3\\\"> <th>ADD\"| __truncated__ \"<center><table><tr><th colspan='2' align='center'><em>Attributes</em></th></tr><tr bgcolor=\\\"#E3E3F3\\\"> <th>ADD\"| __truncated__ ...\n  ..@ coords.nrs : num(0) \n  ..@ coords     : num [1:1925, 1:3] 40986 28309 17829 25580 38981 ...\n  .. ..- attr(*, \"dimnames\")=List of 2\n  ..@ bbox       : num [1:3, 1:2] 11810 25596 0 45404 49301 ...\n  .. ..- attr(*, \"dimnames\")=List of 2\n  ..@ proj4string:Formal class 'CRS' [package \"sp\"] with 1 slot\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchildcare_ppp <- as.ppp(childcare_sf)\nglimpse(childcare_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 6\n $ window    :List of 4\n  ..$ type  : chr \"rectangle\"\n  ..$ xrange: num [1:2] 11810 45404\n  ..$ yrange: num [1:2] 25596 49301\n  ..$ units :List of 3\n  .. ..$ singular  : chr \"unit\"\n  .. ..$ plural    : chr \"units\"\n  .. ..$ multiplier: num 1\n  .. ..- attr(*, \"class\")= chr \"unitname\"\n  ..- attr(*, \"class\")= chr \"owin\"\n $ n         : int 1925\n $ x         : num [1:1925] 40986 28309 17829 25580 38981 ...\n $ y         : num [1:1925] 33848 45530 36607 29222 32483 ...\n $ markformat: chr \"vector\"\n $ marks     : chr [1:1925] \"kml_1\" \"kml_2\" \"kml_3\" \"kml_4\" ...\n - attr(*, \"class\")= chr \"ppp\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(childcare_ppp)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex03_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n## 3.2 Handling duplicated points\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(childcare_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(multiplicity((childcare_ppp)) > 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchildcare_ppp_jit <- rjitter(childcare_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(childcare_ppp_jit))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\n## 3.3 Create owin object: sf method\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsg_owin <- as.owin(sg_sf)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sg_owin)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex03_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchildcare <- childcare_ppp_jit[sg_owin]\nplot(childcare)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex03_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n# 4.0 First-order Spatial Points\n\n\n::: {.cell}\n\n```{.r .cell-code}\npg <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"PUNGGOL\")\ntm <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"TAMPINES\")\nck <- mpsz_sf %>%\n  filter(PLN_AREA_N == \"CHOA CHU KANG\")\njw <- mpsz_sf %>% \n  filter(PLN_AREA_N == \"JURONG WEST\")\n```\n:::\n\n\n## 4.1 Plotting target planning areas\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,2))\nplot(pg, main = \"PUNGGOL\")\n```\n\n::: {.cell-output-display}\n![](In-class_Ex03_files/figure-html/unnamed-chunk-19-1.png){width=1536}\n:::\n\n```{.r .cell-code}\nplot(tm, main = \"TAMPINES\")\n```\n\n::: {.cell-output-display}\n![](In-class_Ex03_files/figure-html/unnamed-chunk-19-2.png){width=1536}\n:::\n\n```{.r .cell-code}\nplot(ck, main = \"CHOA CHU KANG\")\n```\n\n::: {.cell-output-display}\n![](In-class_Ex03_files/figure-html/unnamed-chunk-19-3.png){width=1536}\n:::\n\n```{.r .cell-code}\nplot(jw, main = \"JURONG WEST\")\n```\n\n::: {.cell-output-display}\n![](In-class_Ex03_files/figure-html/unnamed-chunk-19-4.png){width=1536}\n:::\n:::\n",
    "supporting": [
      "In-class_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}