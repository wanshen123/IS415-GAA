<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Wan Shen">
<meta name="description" content="Application of Spatial Point Patterns Analysis to discover the geographical distribution of Grab hailing services in Singapore">

<title>IS415-Wan Shen - Take-home Exercise 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-Wan Shen</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3A</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3B</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/wanshen123/IS415-GAA" rel="" target=""><i class="bi bi-bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Take-home Exercise 1</h1>
                  <div>
        <div class="description">
          Application of Spatial Point Patterns Analysis to discover the geographical distribution of Grab hailing services in Singapore
        </div>
      </div>
                              </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Wan Shen </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">21 Jan, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started">1.0 Getting Started</a></li>
  <li><a href="#spatial-data-wrangling" id="toc-spatial-data-wrangling" class="nav-link" data-scroll-target="#spatial-data-wrangling">2.0 Spatial Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#importing-the-spatial-data" id="toc-importing-the-spatial-data" class="nav-link" data-scroll-target="#importing-the-spatial-data">2.1 Importing the spatial data</a></li>
  <li><a href="#data-pre-processing" id="toc-data-pre-processing" class="nav-link" data-scroll-target="#data-pre-processing">2.2 Data Pre-Processing</a></li>
  <li><a href="#mapping-the-geospatial-data-sets" id="toc-mapping-the-geospatial-data-sets" class="nav-link" data-scroll-target="#mapping-the-geospatial-data-sets">2.3 Mapping the geospatial data sets</a></li>
  </ul></li>
  <li><a href="#geospatial-data-wrangling" id="toc-geospatial-data-wrangling" class="nav-link" data-scroll-target="#geospatial-data-wrangling">3.0 Geospatial Data wrangling</a>
  <ul class="collapse">
  <li><a href="#converting-sf-data-frames-to-sps-spatial-class" id="toc-converting-sf-data-frames-to-sps-spatial-class" class="nav-link" data-scroll-target="#converting-sf-data-frames-to-sps-spatial-class">3.1 Converting sf data frames to sp’s Spatial* class</a></li>
  <li><a href="#converting-the-spatial-class-into-generic-sp-format" id="toc-converting-the-spatial-class-into-generic-sp-format" class="nav-link" data-scroll-target="#converting-the-spatial-class-into-generic-sp-format">3.2 Converting the Spatial* class into generic sp format</a></li>
  <li><a href="#converting-the-generic-sp-format-into-spatstats-ppp-format" id="toc-converting-the-generic-sp-format-into-spatstats-ppp-format" class="nav-link" data-scroll-target="#converting-the-generic-sp-format-into-spatstats-ppp-format">3.3 Converting the generic sp format into spatstat’s ppp format</a></li>
  <li><a href="#combining-point-events-object-and-owin-object" id="toc-combining-point-events-object-and-owin-object" class="nav-link" data-scroll-target="#combining-point-events-object-and-owin-object">3.4 Combining point events object and owin object</a></li>
  </ul></li>
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation">4.0 Kernel Density Estimation</a>
  <ul class="collapse">
  <li><a href="#computing-kernel-density-estimation-using-automatic-bandwidth-selection-method" id="toc-computing-kernel-density-estimation-using-automatic-bandwidth-selection-method" class="nav-link" data-scroll-target="#computing-kernel-density-estimation-using-automatic-bandwidth-selection-method">4.1 Computing kernel density estimation using automatic bandwidth selection method</a></li>
  <li><a href="#rescalling-kde-values" id="toc-rescalling-kde-values" class="nav-link" data-scroll-target="#rescalling-kde-values">4.2 Rescalling KDE values</a></li>
  <li><a href="#working-with-different-automatic-badwidth-methods" id="toc-working-with-different-automatic-badwidth-methods" class="nav-link" data-scroll-target="#working-with-different-automatic-badwidth-methods">4.3 Working with different automatic badwidth methods</a></li>
  <li><a href="#working-with-different-kernel-methods" id="toc-working-with-different-kernel-methods" class="nav-link" data-scroll-target="#working-with-different-kernel-methods">4.4 Working with different kernel methods</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="getting-started" class="level1">
<h1>1.0 Getting Started</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tidyverse, tmap, arrow, lubridate, maptools, raster, spatstat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spatial-data-wrangling" class="level1">
<h1>2.0 Spatial Data Wrangling</h1>
<section id="importing-the-spatial-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-the-spatial-data">2.1 Importing the spatial data</h2>
<p>Aspatial Data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>grab0 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"../../data/TakeHome/TakeHome_01/aspatial/part-00000.parquet"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(grab0, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Geospatial Data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>roadMe <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"../../data/TakeHome/TakeHome_01/geospatial"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">layer =</span> <span class="st">"gis_osm_roads_free_1"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(roadMe, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>islandMe <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"../../data/TakeHome/TakeHome_01/geospatial/MasterPlan2019SubzoneBoundaryNoSeaKML.kml"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(islandMe, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>road_df <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../../data/TakeHome/TakeHome_01/rds/road_df.rds"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>island_df <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../../data/TakeHome/TakeHome_01/rds/island_df.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-pre-processing" class="level2">
<h2 class="anchored" data-anchor-id="data-pre-processing">2.2 Data Pre-Processing</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>road_df <span class="ot">&lt;-</span> road_df[<span class="sc">!</span>(<span class="fu">is.na</span>(road_df<span class="sc">$</span>name)), ]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>island_df <span class="ot">&lt;-</span> island_df[<span class="sc">!</span>(<span class="fu">is.na</span>(island_df<span class="sc">$</span>geometry)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>grab0_df<span class="sc">$</span>pingtimestamp <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(grab0_df<span class="sc">$</span>pingtimestamp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>origin0_df <span class="ot">&lt;-</span> grab0_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trj_id) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(pingtimestamp) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">wday</span>(pingtimestamp,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label=</span><span class="cn">TRUE</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr=</span><span class="cn">TRUE</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">start_hr =</span> <span class="fu">factor</span>(<span class="fu">hour</span>(pingtimestamp)),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">mday</span>(pingtimestamp)))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>origin0_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>grab0_df <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../../data/TakeHome/TakeHome_01/rds/grab0.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using the crs info function to retrieve the referencing system information of these geospatial data.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>crs_info1 <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(road_df)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>crs_info2 <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(island_df)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>crs_info1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>crs_info2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Preparing the following geospatial data layer in sf tibble data.frames.</p>
</div>
</div>
<p>Road layer within Singapore excluding outer islands.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tibble1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(road_df)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>tibble1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 317,780 × 11
   osm_id   code fclass      name      ref   oneway maxspeed layer bridge tunnel
   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; 
 1 4386520  5113 primary     Orchard … &lt;NA&gt;  F            50     0 F      F     
 2 4578273  5114 secondary   Jalan Bu… &lt;NA&gt;  F             0     0 F      F     
 3 4579495  5122 residential Jalan Na… &lt;NA&gt;  B             0     0 F      F     
 4 4579533  5122 residential Persiara… &lt;NA&gt;  B             0     0 F      F     
 5 4579534  5122 residential Jalan Ce… &lt;NA&gt;  B             0     0 F      F     
 6 4579536  5122 residential Changkat… &lt;NA&gt;  F             0     0 F      F     
 7 4585475  5122 residential Jalan Ha… &lt;NA&gt;  F             0     0 F      F     
 8 4585480  5122 residential Jalan Be… &lt;NA&gt;  F             0     0 F      F     
 9 4585482  5122 residential Jalan Be… &lt;NA&gt;  F             0     0 F      F     
10 4661703  5122 residential Jalan 1/… &lt;NA&gt;  B             0     0 F      F     
# ℹ 317,770 more rows
# ℹ 1 more variable: geometry &lt;LINESTRING [°]&gt;</code></pre>
</div>
</div>
<p>Singapore boundary layer excluding outer islands</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tibble2 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(island_df)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tibble2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 332 × 3
   Name   Description                                                   geometry
   &lt;chr&gt;  &lt;chr&gt;                                               &lt;MULTIPOLYGON [°]&gt;
 1 kml_1  "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8145 1.282387 0…
 2 kml_2  "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8221 1.280494 0…
 3 kml_3  "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8438 1.285079 0…
 4 kml_4  "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8496 1.284119 0…
 5 kml_5  "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8525 1.286166 0…
 6 kml_6  "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8486 1.282317 0…
 7 kml_7  "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8311 1.287163 0…
 8 kml_8  "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8589 1.278739 0…
 9 kml_9  "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8283 1.287235 0…
10 kml_10 "&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='… Z (((103.8552 1.28322 0,…
# ℹ 322 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Changing the referencing system to Singapore national projected coordinate system.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>road_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(road_df, <span class="at">crs =</span> <span class="dv">3414</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>island_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(island_df, <span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>grab0_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(grab0_df, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"rawlng"</span>, <span class="st">"rawlat"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(grab0_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 28,000
Columns: 11
Groups: trj_id [28,000]
$ trj_id        &lt;chr&gt; "70895", "21926", "47498", "41322", "18103", "64813", "8…
$ driving_mode  &lt;chr&gt; "car", "car", "car", "car", "car", "car", "car", "car", …
$ osname        &lt;chr&gt; "android", "android", "ios", "android", "android", "ios"…
$ pingtimestamp &lt;dttm&gt; 2019-04-08 00:09:40, 2019-04-08 00:09:49, 2019-04-08 00…
$ speed         &lt;dbl&gt; 6.799661, 10.812810, 18.307493, 18.670000, 14.072143, 19…
$ bearing       &lt;int&gt; 41, 68, 307, 230, 155, 109, 213, 202, 179, 109, 312, 209…
$ accuracy      &lt;dbl&gt; 4.000, 4.000, 8.000, 3.900, 4.000, 10.000, 10.000, 10.00…
$ weekday       &lt;ord&gt; Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, M…
$ start_hr      &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ day           &lt;fct&gt; 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,…
$ geometry      &lt;POINT [m]&gt; POINT (21053.57 40263.52), POINT (31268.41 30410.2…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>island_sf <span class="ot">&lt;-</span> <span class="fu">st_zm</span>(island_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sf_df <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(road_sf, <span class="at">wkt =</span> <span class="st">"geometry"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>roads_in_singapore <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(sf_df, island_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mapping-the-geospatial-data-sets" class="level2">
<h2 class="anchored" data-anchor-id="mapping-the-geospatial-data-sets">2.3 Mapping the geospatial data sets</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>After checking the referencing system of each geospatial data data frame, it is also useful for us to plot a map to show their spatial patterns.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>roads_in_singapore <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(roads_in_singapore, <span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Grab Taxi Location Points</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(grab0_sf) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Master Plan 2019 Planning Subzone Boundary with Grab Taxi Location Points</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(island_sf) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(grab0_sf) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tm_shape(island_sf) +</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  tm_polygons() +</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#tm_shape(roads_in_singapore) +</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  tm_dots()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="geospatial-data-wrangling" class="level1">
<h1>3.0 Geospatial Data wrangling</h1>
<section id="converting-sf-data-frames-to-sps-spatial-class" class="level2">
<h2 class="anchored" data-anchor-id="converting-sf-data-frames-to-sps-spatial-class">3.1 Converting sf data frames to sp’s Spatial* class</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The code chunk below uses as_Spatial() of sf package to convert the three geospatial data from simple feature data frame to sp’s Spatial* class.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>island <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(island_sf)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>grab0_as <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(grab0_sf)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>road <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(roads_in_singapore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>road_as <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../../data/TakeHome/TakeHome_01/rds/as_road_df.rds"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>island_as <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../../data/TakeHome/TakeHome_01/rds/as_island_df.rds"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>grab0_as <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../../data/TakeHome/TakeHome_01/rds/as_grab0_df.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>island_as</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 332 
extent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 2
names       :   Name,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Description 
min values  :  kml_1, &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;SUBZONE_NO&lt;/th&gt; &lt;td&gt;1&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;SUBZONE_N&lt;/th&gt; &lt;td&gt;ANAK BUKIT&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;SUBZONE_C&lt;/th&gt; &lt;td&gt;BTSZ01&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;CA_IND&lt;/th&gt; &lt;td&gt;N&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;PLN_AREA_N&lt;/th&gt; &lt;td&gt;BUKIT TIMAH&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PLN_AREA_C&lt;/th&gt; &lt;td&gt;BT&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;REGION_N&lt;/th&gt; &lt;td&gt;CENTRAL REGION&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;REGION_C&lt;/th&gt; &lt;td&gt;CR&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;4BAD8B2C9CEBF3F2&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20191223152313&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt; 
max values  : kml_99,       &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;SUBZONE_NO&lt;/th&gt; &lt;td&gt;9&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;SUBZONE_N&lt;/th&gt; &lt;td&gt;YISHUN WEST&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;SUBZONE_C&lt;/th&gt; &lt;td&gt;YSSZ09&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;CA_IND&lt;/th&gt; &lt;td&gt;N&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;PLN_AREA_N&lt;/th&gt; &lt;td&gt;YISHUN&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PLN_AREA_C&lt;/th&gt; &lt;td&gt;YS&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;REGION_N&lt;/th&gt; &lt;td&gt;NORTH REGION&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;REGION_C&lt;/th&gt; &lt;td&gt;NR&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;95C11920195B86C7&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20191223152313&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt; </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>road_as</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialLinesDataFrame 
features    : 83463 
extent      : 3620.434, 55604.55, 23099.51, 50154.22  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 12
names       :     osm_id, code,   fclass,                                       name, ref, oneway, maxspeed, layer, bridge, tunnel,   Name,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Description 
min values  : 1000098060, 5111, cycleway, 105 Henderson Crescent Lobby Drive-Through,   1,      B,        0,    -2,      F,      F,  kml_1, &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;SUBZONE_NO&lt;/th&gt; &lt;td&gt;1&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;SUBZONE_N&lt;/th&gt; &lt;td&gt;ANAK BUKIT&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;SUBZONE_C&lt;/th&gt; &lt;td&gt;BTSZ01&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;CA_IND&lt;/th&gt; &lt;td&gt;N&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;PLN_AREA_N&lt;/th&gt; &lt;td&gt;BUKIT TIMAH&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PLN_AREA_C&lt;/th&gt; &lt;td&gt;BT&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;REGION_N&lt;/th&gt; &lt;td&gt;CENTRAL REGION&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;REGION_C&lt;/th&gt; &lt;td&gt;CR&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;4BAD8B2C9CEBF3F2&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20191223152313&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt; 
max values  :  999921410, 5199,  unknown,                           Zubir Said Drive, TPE,      T,       90,     5,      T,      T, kml_99,       &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;SUBZONE_NO&lt;/th&gt; &lt;td&gt;9&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;SUBZONE_N&lt;/th&gt; &lt;td&gt;YISHUN WEST&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;SUBZONE_C&lt;/th&gt; &lt;td&gt;YSSZ09&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;CA_IND&lt;/th&gt; &lt;td&gt;N&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;PLN_AREA_N&lt;/th&gt; &lt;td&gt;YISHUN&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;PLN_AREA_C&lt;/th&gt; &lt;td&gt;YS&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;REGION_N&lt;/th&gt; &lt;td&gt;NORTH REGION&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;REGION_C&lt;/th&gt; &lt;td&gt;NR&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor="#E3E3F3"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;95C11920195B86C7&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=""&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20191223152313&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt; </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>grab0_as</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3034553 features and 7 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3638.685 ymin: 24913.65 xmax: 50040.9 ymax: 49685.08
Projected CRS: SVY21 / Singapore TM
# A tibble: 3,034,553 × 8
   trj_id driving_mode osname  pingtimestamp       speed bearing accuracy
 * &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;   &lt;dttm&gt;              &lt;dbl&gt;   &lt;int&gt;    &lt;dbl&gt;
 1 70014  car          android 2019-04-11 00:40:36 18.9      248     3.9 
 2 73573  car          android 2019-04-18 10:17:03 17.7       44     4   
 3 75567  car          android 2019-04-13 07:37:06 14.0       34     3.9 
 4 1410   car          android 2019-04-20 03:41:33 13.0      181     4   
 5 4354   car          android 2019-04-18 10:48:17 14.8       93     3.9 
 6 32630  car          android 2019-04-16 06:14:18 23.2       73     3.9 
 7 64631  car          android 2019-04-09 00:15:55  0         82     3   
 8 76484  car          android 2019-04-09 04:18:52  3.98     321     3.65
 9 65747  car          ios     2019-04-10 12:13:38  4.68     324    50   
10 60478  car          ios     2019-04-18 13:13:09 16.5       31    16   
# ℹ 3,034,543 more rows
# ℹ 1 more variable: geometry &lt;POINT [m]&gt;</code></pre>
</div>
</div>
</section>
<section id="converting-the-spatial-class-into-generic-sp-format" class="level2">
<h2 class="anchored" data-anchor-id="converting-the-spatial-class-into-generic-sp-format">3.2 Converting the Spatial* class into generic sp format</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since spatstat requires the analytical data in ppp object form. There is no direct way to convert a Spatial* classes into ppp object. We need to convert the Spatial classes* into Spatial object first.</p>
<p>The codes chunk below converts the Spatial* classes into generic sp objects.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>island_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(island_as, <span class="st">"SpatialPolygons"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>road_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(road_as, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>grab0_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(grab0_as, <span class="st">"Spatial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>road_sp <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../../data/TakeHome/TakeHome_01/rds/sp_road_df.rds"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>island_sp <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../../data/TakeHome/TakeHome_01/rds/sp_island_df.rds"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>grab0_sp <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"../../data/TakeHome/TakeHome_01/rds/sp_grab0_df.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>island_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygons 
features    : 332 
extent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>road_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPoints 
features    : 286009 
extent      : 3620.434, 55604.55, 23099.51, 50154.22  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>grab0_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 3034553 
extent      : 3638.685, 50040.9, 24913.65, 49685.08  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 7
names       : trj_id, driving_mode,  osname, pingtimestamp, speed, bearing, accuracy 
min values  :     10,          car, android,    1554682180,    -1,       0,        1 
max values  :   9984,          car,     ios,    1555890997,    89,     359,     2465 </code></pre>
</div>
</div>
</section>
<section id="converting-the-generic-sp-format-into-spatstats-ppp-format" class="level2">
<h2 class="anchored" data-anchor-id="converting-the-generic-sp-format-into-spatstats-ppp-format">3.3 Converting the generic sp format into spatstat’s ppp format</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Now, we will use as.ppp() function of spatstat to convert the spatial data into spatstat’s ppp object format.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>road_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(road_sp, <span class="st">"ppp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(road_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(road_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  286009 points
Average intensity 0.0002033603 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: rectangle = [3620.43, 55604.55] x [23099.51, 50154.22] units
                    (51980 x 27050 units)
Window area = 1406410000 square units</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#grab0_ppp &lt;- as(grab0_sp, "ppp")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(grab0_ppp)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(grab0_ppp)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>sg_owin <span class="ot">&lt;-</span> <span class="fu">as</span>(island_sp, <span class="st">"owin"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sg_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Window: polygonal boundary
387 separate polygons (13 holes)
                   vertices         area relative.area
polygon 1                85  4.42298e+05      5.64e-04
polygon 2                38  4.11723e+05      5.25e-04
polygon 3               227  5.87223e+05      7.48e-04
polygon 4                35  3.94379e+04      5.03e-05
polygon 5                96  1.88767e+05      2.41e-04
polygon 6                59  1.33007e+05      1.69e-04
polygon 7                47  4.48128e+05      5.71e-04
polygon 8                31  5.21201e+05      6.64e-04
polygon 9                17  3.50788e+05      4.47e-04
polygon 10               54  2.61844e+05      3.34e-04
polygon 11              152  1.63038e+06      2.08e-03
polygon 12              273  6.14924e+05      7.84e-04
polygon 13              299  1.84404e+06      2.35e-03
polygon 14              165  3.92563e+05      5.00e-04
polygon 15              239  5.06589e+05      6.46e-04
polygon 16             1265  3.29427e+07      4.20e-02
polygon 17 (hole)         3 -3.79135e-02     -4.83e-11
polygon 18              487  2.06117e+06      2.63e-03
polygon 19              264  1.50631e+06      1.92e-03
polygon 20               65  8.42861e+04      1.07e-04
polygon 21               47  3.82087e+04      4.87e-05
polygon 22               22  6.74651e+03      8.60e-06
polygon 23              133  3.88733e+05      4.95e-04
polygon 24              181  5.61609e+05      7.16e-04
polygon 25               47  1.60807e+05      2.05e-04
polygon 26               49  5.95247e+05      7.58e-04
polygon 27               49  3.87612e+05      4.94e-04
polygon 28               59  1.03038e+06      1.31e-03
polygon 29               83  5.51732e+05      7.03e-04
polygon 30               69  2.90185e+05      3.70e-04
polygon 31              217  1.08479e+06      1.38e-03
polygon 32               41  6.28893e+05      8.01e-04
polygon 33              255  1.59034e+06      2.03e-03
polygon 34              234  2.08755e+06      2.66e-03
polygon 35              227  1.10308e+06      1.41e-03
polygon 36              145  9.61782e+05      1.23e-03
polygon 37               19  3.09221e+04      3.94e-05
polygon 38               37  1.29481e+04      1.65e-05
polygon 39               10  6.60195e+03      8.41e-06
polygon 40               30  4.28933e+03      5.47e-06
polygon 41                4  9.47108e+01      1.21e-07
polygon 42             1045  4.44510e+06      5.66e-03
polygon 43 (hole)        13 -3.91907e+02     -4.99e-07
polygon 44              232  4.72886e+05      6.03e-04
polygon 45               15  4.03300e+04      5.14e-05
polygon 46               14  5.86546e+03      7.47e-06
polygon 47             1020  1.27781e+06      1.63e-03
polygon 48 (hole)         7 -6.28298e-05     -8.01e-14
polygon 49 (hole)         3 -3.23305e-04     -4.12e-13
polygon 50 (hole)         3 -1.20875e-01     -1.54e-10
polygon 51 (hole)        12 -5.81913e-01     -7.41e-10
polygon 52 (hole)         4 -6.55702e-01     -8.36e-10
polygon 53              211  4.70521e+05      6.00e-04
polygon 54              155  2.67502e+05      3.41e-04
polygon 55              129  9.53761e+04      1.22e-04
polygon 56               94  5.96187e+04      7.60e-05
polygon 57               59  3.43150e+04      4.37e-05
polygon 58               10  4.90942e+02      6.26e-07
polygon 59                6  4.50259e+02      5.74e-07
polygon 60                4  2.69313e+02      3.43e-07
polygon 61             1432  4.87153e+06      6.21e-03
polygon 62 (hole)         4 -1.72650e-04     -2.20e-13
polygon 63 (hole)         3 -2.33435e-03     -2.97e-12
polygon 64 (hole)         3 -1.37223e-02     -1.75e-11
polygon 65 (hole)        11 -8.36705e+01     -1.07e-07
polygon 66               75  1.73526e+04      2.21e-05
polygon 67               40  1.38607e+04      1.77e-05
polygon 68               83  5.28920e+03      6.74e-06
polygon 69              139  3.22293e+03      4.11e-06
polygon 70              148  3.10395e+03      3.96e-06
polygon 71              106  3.04104e+03      3.88e-06
polygon 72               45  2.51218e+03      3.20e-06
polygon 73              442  3.45157e+06      4.40e-03
polygon 74               84  1.03238e+05      1.32e-04
polygon 75              102  1.12730e+06      1.44e-03
polygon 76             1179  2.69866e+06      3.44e-03
polygon 77               88  5.33463e+05      6.80e-04
polygon 78               95  1.45519e+05      1.85e-04
polygon 79               55  6.35704e+05      8.10e-04
polygon 80               53  2.76827e+05      3.53e-04
polygon 81              114  6.36650e+04      8.11e-05
polygon 82               83  1.96620e+05      2.51e-04
polygon 83               33  3.65333e+05      4.66e-04
polygon 84              110  1.45503e+06      1.85e-03
polygon 85              135  8.53207e+05      1.09e-03
polygon 86              196  1.07072e+06      1.36e-03
polygon 87               47  5.33013e+05      6.79e-04
polygon 88              130  2.80175e+05      3.57e-04
polygon 89              141  2.14250e+05      2.73e-04
polygon 90               83  1.73122e+05      2.21e-04
polygon 91              192  5.91779e+05      7.54e-04
polygon 92              174  1.75348e+06      2.23e-03
polygon 93              193  3.40743e+05      4.34e-04
polygon 94               59  3.10534e+05      3.96e-04
polygon 95              114  1.38034e+06      1.76e-03
polygon 96              134  1.95176e+06      2.49e-03
polygon 97              270  4.51538e+05      5.75e-04
polygon 98               80  6.97502e+05      8.89e-04
polygon 99              124  1.72655e+05      2.20e-04
polygon 100             277  1.09783e+06      1.40e-03
polygon 101             137  1.05800e+06      1.35e-03
polygon 102             313  2.79680e+06      3.56e-03
polygon 103             496  3.05099e+06      3.89e-03
polygon 104             139  3.36221e+05      4.28e-04
polygon 105              62  7.42203e+05      9.46e-04
polygon 106             226  1.82685e+06      2.33e-03
polygon 107              56  2.93695e+05      3.74e-04
polygon 108             256  5.57276e+05      7.10e-04
polygon 109              48  5.56813e+04      7.10e-05
polygon 110              60  1.16330e+05      1.48e-04
polygon 111             352  2.00345e+06      2.55e-03
polygon 112             129  2.43459e+06      3.10e-03
polygon 113             114  1.07899e+06      1.37e-03
polygon 114             322  4.60550e+05      5.87e-04
polygon 115             198  5.43484e+05      6.93e-04
polygon 116              51  2.78304e+05      3.55e-04
polygon 117             694  1.77060e+06      2.26e-03
polygon 118             297  8.86955e+05      1.13e-03
polygon 119             182  2.18808e+05      2.79e-04
polygon 120             219  3.29438e+05      4.20e-04
polygon 121              88  1.70664e+05      2.17e-04
polygon 122             218  1.34616e+06      1.72e-03
polygon 123              27  1.71334e+05      2.18e-04
polygon 124              84  4.96260e+04      6.32e-05
polygon 125             199  1.93992e+05      2.47e-04
polygon 126              77  1.20171e+05      1.53e-04
polygon 127             108  1.02656e+06      1.31e-03
polygon 128             130  2.00787e+05      2.56e-04
polygon 129             169  7.10569e+05      9.05e-04
polygon 130              34  7.48684e+05      9.54e-04
polygon 131             173  3.68483e+05      4.70e-04
polygon 132             298  7.60621e+06      9.69e-03
polygon 133             239  2.21998e+05      2.83e-04
polygon 134              75  1.26341e+06      1.61e-03
polygon 135              50  3.69771e+05      4.71e-04
polygon 136              83  3.20366e+06      4.08e-03
polygon 137              96  1.10727e+06      1.41e-03
polygon 138              43  5.54624e+05      7.07e-04
polygon 139             126  3.38724e+06      4.32e-03
polygon 140              94  1.87800e+06      2.39e-03
polygon 141              40  8.67750e+05      1.11e-03
polygon 142              55  6.39144e+05      8.14e-04
polygon 143              39  3.26015e+06      4.15e-03
polygon 144              54  4.11404e+05      5.24e-04
polygon 145              75  4.18657e+05      5.33e-04
polygon 146             104  2.09818e+06      2.67e-03
polygon 147              91  1.52455e+06      1.94e-03
polygon 148              74  2.18107e+05      2.78e-04
polygon 149             105  2.13519e+05      2.72e-04
polygon 150             215  2.47266e+06      3.15e-03
polygon 151 (hole)       38 -7.79904e+03     -9.94e-06
polygon 152               4  1.41753e-02      1.81e-11
polygon 153              58  3.16882e+05      4.04e-04
polygon 154              94  1.04642e+06      1.33e-03
polygon 155              63  9.21431e+05      1.17e-03
polygon 156              57  2.39334e+06      3.05e-03
polygon 157             608  1.94141e+06      2.47e-03
polygon 158             325  2.12118e+06      2.70e-03
polygon 159             119  4.85572e+05      6.19e-04
polygon 160             102  7.56926e+05      9.65e-04
polygon 161             111  4.29714e+06      5.48e-03
polygon 162             110  9.91057e+05      1.26e-03
polygon 163             383  2.03851e+06      2.60e-03
polygon 164             125  2.57843e+06      3.29e-03
polygon 165              91  3.18758e+06      4.06e-03
polygon 166              35  2.56100e+06      3.26e-03
polygon 167             112  7.35502e+05      9.37e-04
polygon 168             118  3.51305e+05      4.48e-04
polygon 169              69  1.31292e+06      1.67e-03
polygon 170              67  9.47453e+05      1.21e-03
polygon 171             100  7.49199e+05      9.55e-04
polygon 172              93  1.05203e+06      1.34e-03
polygon 173              92  4.10939e+05      5.24e-04
polygon 174              72  8.39679e+05      1.07e-03
polygon 175             184  1.22706e+06      1.56e-03
polygon 176             120  5.58761e+05      7.12e-04
polygon 177             212  2.09609e+06      2.67e-03
polygon 178              88  7.22589e+05      9.21e-04
polygon 179             281  2.55046e+06      3.25e-03
polygon 180              34  2.04263e+06      2.60e-03
polygon 181              70  3.26040e+06      4.15e-03
polygon 182             119  2.15829e+06      2.75e-03
polygon 183             140  1.34746e+06      1.72e-03
polygon 184              60  2.33891e+06      2.98e-03
polygon 185             154  1.67537e+05      2.13e-04
polygon 186              81  1.16002e+06      1.48e-03
polygon 187              92  2.34938e+06      2.99e-03
polygon 188              86  9.63495e+05      1.23e-03
polygon 189              35  4.85022e+05      6.18e-04
polygon 190              82  1.88131e+06      2.40e-03
polygon 191             103  1.42508e+06      1.82e-03
polygon 192              60  2.38728e+06      3.04e-03
polygon 193              74  1.22989e+06      1.57e-03
polygon 194             123  9.63925e+05      1.23e-03
polygon 195             182  2.77330e+06      3.53e-03
polygon 196             131  3.46851e+06      4.42e-03
polygon 197             452  7.65582e+06      9.76e-03
polygon 198             124  9.48159e+05      1.21e-03
polygon 199             132  1.31911e+06      1.68e-03
polygon 200              60  2.99731e+06      3.82e-03
polygon 201             237  1.97413e+06      2.52e-03
polygon 202             132  1.77073e+06      2.26e-03
polygon 203             210  1.78725e+05      2.28e-04
polygon 204              91  1.49663e+04      1.91e-05
polygon 205              71  8.18750e+03      1.04e-05
polygon 206              84  2.25924e+06      2.88e-03
polygon 207              58  8.59179e+05      1.09e-03
polygon 208              71  1.94861e+06      2.48e-03
polygon 209              87  1.07862e+06      1.37e-03
polygon 210             151  3.02315e+06      3.85e-03
polygon 211              35  4.41733e+05      5.63e-04
polygon 212              60  9.72128e+05      1.24e-03
polygon 213              94  1.23590e+06      1.57e-03
polygon 214             101  1.63984e+06      2.09e-03
polygon 215             107  2.54311e+06      3.24e-03
polygon 216              83  9.55710e+05      1.22e-03
polygon 217             165  8.94516e+05      1.14e-03
polygon 218              76  9.11208e+05      1.16e-03
polygon 219              43  1.14381e+06      1.46e-03
polygon 220             122  1.37683e+06      1.75e-03
polygon 221             129  1.92662e+06      2.45e-03
polygon 222             374  4.13716e+06      5.27e-03
polygon 223              79  1.06189e+06      1.35e-03
polygon 224              75  1.79446e+06      2.29e-03
polygon 225             101  3.47525e+06      4.43e-03
polygon 226              94  1.23166e+06      1.57e-03
polygon 227              52  6.84704e+05      8.72e-04
polygon 228             159  1.08508e+06      1.38e-03
polygon 229              44  1.97494e+06      2.52e-03
polygon 230             141  4.14132e+06      5.28e-03
polygon 231             159  4.34375e+06      5.53e-03
polygon 232              59  1.51553e+06      1.93e-03
polygon 233              60  9.44998e+05      1.20e-03
polygon 234             191  1.99363e+06      2.54e-03
polygon 235             113  2.07797e+06      2.65e-03
polygon 236             136  3.14493e+06      4.01e-03
polygon 237             195  2.63648e+06      3.36e-03
polygon 238              80  1.05717e+06      1.35e-03
polygon 239              56  1.28795e+06      1.64e-03
polygon 240              69  4.39647e+05      5.60e-04
polygon 241              50  7.46882e+05      9.52e-04
polygon 242             108  2.77750e+06      3.54e-03
polygon 243              40  9.06317e+05      1.15e-03
polygon 244              41  3.80202e+05      4.84e-04
polygon 245              82  5.27472e+05      6.72e-04
polygon 246              77  8.00299e+05      1.02e-03
polygon 247             147  8.98555e+05      1.14e-03
polygon 248             154  1.79616e+06      2.29e-03
polygon 249             130  2.25124e+06      2.87e-03
polygon 250             125  7.76142e+05      9.89e-04
polygon 251              61  4.46242e+05      5.69e-04
polygon 252              72  5.72502e+05      7.30e-04
polygon 253              79  8.13383e+05      1.04e-03
polygon 254              94  1.48430e+06      1.89e-03
polygon 255             342  1.97707e+06      2.52e-03
polygon 256              97  1.03728e+06      1.32e-03
polygon 257             167  2.82095e+06      3.59e-03
polygon 258              56  9.24763e+05      1.18e-03
polygon 259             119  1.80638e+06      2.30e-03
polygon 260              64  1.40454e+06      1.79e-03
polygon 261              91  2.37933e+06      3.03e-03
polygon 262             318  8.50229e+06      1.08e-02
polygon 263 (hole)      317 -5.11280e+04     -6.51e-05
polygon 264             368  1.37341e+06      1.75e-03
polygon 265              67  1.43138e+05      1.82e-04
polygon 266              64  4.36369e+05      5.56e-04
polygon 267             127  1.51149e+06      1.93e-03
polygon 268             152  2.45625e+06      3.13e-03
polygon 269              80  1.28721e+06      1.64e-03
polygon 270              32  8.42668e+05      1.07e-03
polygon 271              61  1.33353e+06      1.70e-03
polygon 272              50  1.00741e+06      1.28e-03
polygon 273             235  4.80393e+06      6.12e-03
polygon 274             245  4.70675e+05      6.00e-04
polygon 275              95  1.32888e+06      1.69e-03
polygon 276             114  6.01727e+05      7.67e-04
polygon 277              66  7.63183e+05      9.72e-04
polygon 278              68  9.24866e+05      1.18e-03
polygon 279              55  8.62737e+05      1.10e-03
polygon 280             105  1.58344e+06      2.02e-03
polygon 281              43  8.46137e+05      1.08e-03
polygon 282             256  9.97938e+05      1.27e-03
polygon 283              59  1.46053e+06      1.86e-03
polygon 284              47  1.49668e+06      1.91e-03
polygon 285             153  1.66709e+06      2.12e-03
polygon 286              81  2.39163e+06      3.05e-03
polygon 287              52  1.37871e+06      1.76e-03
polygon 288             100  9.23215e+05      1.18e-03
polygon 289             246  5.32542e+06      6.79e-03
polygon 290             122  1.74439e+06      2.22e-03
polygon 291              76  1.00320e+06      1.28e-03
polygon 292              68  1.09569e+06      1.40e-03
polygon 293              53  6.68454e+05      8.52e-04
polygon 294              69  6.24878e+05      7.96e-04
polygon 295              85  6.74992e+05      8.60e-04
polygon 296             123  2.33068e+06      2.97e-03
polygon 297              68  1.09321e+06      1.39e-03
polygon 298              83  1.86187e+06      2.37e-03
polygon 299              45  9.09419e+05      1.16e-03
polygon 300             102  2.10616e+06      2.68e-03
polygon 301             204  3.33419e+06      4.25e-03
polygon 302             285  1.71970e+06      2.19e-03
polygon 303              87  1.08864e+06      1.39e-03
polygon 304              81  1.56903e+06      2.00e-03
polygon 305              83  1.46451e+06      1.87e-03
polygon 306             105  2.20631e+06      2.81e-03
polygon 307             107  1.18013e+06      1.50e-03
polygon 308             174  1.79346e+06      2.29e-03
polygon 309             112  3.91607e+06      4.99e-03
polygon 310             148  2.17538e+06      2.77e-03
polygon 311             141  3.62301e+06      4.62e-03
polygon 312              80  1.43291e+06      1.83e-03
polygon 313             114  4.38842e+06      5.59e-03
polygon 314             162  1.20044e+06      1.53e-03
polygon 315             128  1.34017e+06      1.71e-03
polygon 316             263  3.28413e+06      4.18e-03
polygon 317             118  2.55346e+06      3.25e-03
polygon 318              49  9.61422e+05      1.23e-03
polygon 319             112  1.28130e+06      1.63e-03
polygon 320              26  7.58123e+05      9.66e-04
polygon 321              76  9.05921e+05      1.15e-03
polygon 322             100  1.41803e+06      1.81e-03
polygon 323              50  1.48925e+06      1.90e-03
polygon 324             117  5.18613e+06      6.61e-03
polygon 325              71  2.35997e+05      3.01e-04
polygon 326             265  5.86424e+06      7.47e-03
polygon 327             103  4.47203e+06      5.70e-03
polygon 328              75  5.00139e+05      6.37e-04
polygon 329              86  6.97637e+05      8.89e-04
polygon 330             306  1.13095e+06      1.44e-03
polygon 331              86  1.45916e+06      1.86e-03
polygon 332              42  7.84712e+05      1.00e-03
polygon 333              68  1.04642e+06      1.33e-03
polygon 334              59  8.99103e+05      1.15e-03
polygon 335              28  7.80760e+05      9.95e-04
polygon 336             323  4.82857e+05      6.15e-04
polygon 337             535  2.45095e+06      3.12e-03
polygon 338              77  2.20921e+06      2.82e-03
polygon 339              79  1.26204e+06      1.61e-03
polygon 340              40  1.25241e+06      1.60e-03
polygon 341             779  3.71587e+07      4.73e-02
polygon 342             125  1.54073e+06      1.96e-03
polygon 343             378  1.63581e+06      2.08e-03
polygon 344             361  2.24122e+06      2.86e-03
polygon 345             667  3.56692e+07      4.55e-02
polygon 346              97  9.13524e+04      1.16e-04
polygon 347             128  1.71195e+06      2.18e-03
polygon 348             163  2.96147e+06      3.77e-03
polygon 349             130  1.25974e+06      1.61e-03
polygon 350               3  6.44872e-01      8.22e-10
polygon 351             112  3.29141e+06      4.19e-03
polygon 352             102  1.57600e+06      2.01e-03
polygon 353             124  1.66419e+06      2.12e-03
polygon 354              94  1.76925e+06      2.25e-03
polygon 355            1954  6.85075e+07      8.73e-02
polygon 356              30  2.80002e+04      3.57e-05
polygon 357              27  1.50315e+04      1.92e-05
polygon 358             103  2.05005e+06      2.61e-03
polygon 359             285  1.61128e+06      2.05e-03
polygon 360              66  1.26165e+06      1.61e-03
polygon 361            1633  1.74954e+07      2.23e-02
polygon 362             164  3.45046e+06      4.40e-03
polygon 363              65  1.74336e+06      2.22e-03
polygon 364              73  1.39448e+06      1.78e-03
polygon 365             141  1.07438e+06      1.37e-03
polygon 366             129  1.51777e+06      1.93e-03
polygon 367             117  5.95652e+05      7.59e-04
polygon 368             719  5.40368e+07      6.89e-02
polygon 369             709  1.28815e+07      1.64e-02
polygon 370              77  3.29939e+05      4.20e-04
polygon 371              44  2.26577e+03      2.89e-06
polygon 372             193  2.14708e+06      2.74e-03
polygon 373              90  1.51100e+06      1.93e-03
polygon 374             125  9.36416e+05      1.19e-03
polygon 375             148  1.64863e+06      2.10e-03
polygon 376             102  1.09939e+06      1.40e-03
polygon 377             158  3.65203e+06      4.65e-03
polygon 378             373  7.05426e+06      8.99e-03
polygon 379             209  7.23576e+06      9.22e-03
polygon 380             103  2.20675e+06      2.81e-03
polygon 381             269  3.84951e+06      4.91e-03
polygon 382             103  6.87914e+05      8.77e-04
polygon 383              75  5.46394e+05      6.96e-04
polygon 384             103  1.96414e+06      2.50e-03
polygon 385             734  2.77044e+07      3.53e-02
polygon 386              71  5.63061e+03      7.17e-06
polygon 387              10  1.99717e+02      2.54e-07
enclosing rectangle: [2667.54, 56396.44] x [15748.72, 50256.33] units
                     (53730 x 34510 units)
Window area = 784784000 square units
Fraction of frame area: 0.423</code></pre>
</div>
</div>
</section>
<section id="combining-point-events-object-and-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="combining-point-events-object-and-owin-object">3.4 Combining point events object and owin object</h2>
<p>In this last step of geospatial data wrangling, we will extract childcare events that are located within Singapore by using the code chunk below.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Plot the newly derived islandSG_ppp as shown below.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>islandSG_ppp_road <span class="ot">=</span> road_ppp[sg_owin]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(islandSG_ppp_road)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(islandSG_ppp_road)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  285725 points
Average intensity 0.0003640811 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 3 decimal places
i.e. rounded to the nearest multiple of 0.001 units

Window: polygonal boundary
387 separate polygons (13 holes)
                   vertices         area relative.area
polygon 1                85  4.42298e+05      5.64e-04
polygon 2                38  4.11723e+05      5.25e-04
polygon 3               227  5.87223e+05      7.48e-04
polygon 4                35  3.94379e+04      5.03e-05
polygon 5                96  1.88767e+05      2.41e-04
polygon 6                59  1.33007e+05      1.69e-04
polygon 7                47  4.48128e+05      5.71e-04
polygon 8                31  5.21201e+05      6.64e-04
polygon 9                17  3.50788e+05      4.47e-04
polygon 10               54  2.61844e+05      3.34e-04
polygon 11              152  1.63038e+06      2.08e-03
polygon 12              273  6.14924e+05      7.84e-04
polygon 13              299  1.84404e+06      2.35e-03
polygon 14              165  3.92563e+05      5.00e-04
polygon 15              239  5.06589e+05      6.46e-04
polygon 16             1265  3.29427e+07      4.20e-02
polygon 17 (hole)         3 -3.79135e-02     -4.83e-11
polygon 18              487  2.06117e+06      2.63e-03
polygon 19              264  1.50631e+06      1.92e-03
polygon 20               65  8.42861e+04      1.07e-04
polygon 21               47  3.82087e+04      4.87e-05
polygon 22               22  6.74651e+03      8.60e-06
polygon 23              133  3.88733e+05      4.95e-04
polygon 24              181  5.61609e+05      7.16e-04
polygon 25               47  1.60807e+05      2.05e-04
polygon 26               49  5.95247e+05      7.58e-04
polygon 27               49  3.87612e+05      4.94e-04
polygon 28               59  1.03038e+06      1.31e-03
polygon 29               83  5.51732e+05      7.03e-04
polygon 30               69  2.90185e+05      3.70e-04
polygon 31              217  1.08479e+06      1.38e-03
polygon 32               41  6.28893e+05      8.01e-04
polygon 33              255  1.59034e+06      2.03e-03
polygon 34              234  2.08755e+06      2.66e-03
polygon 35              227  1.10308e+06      1.41e-03
polygon 36              145  9.61782e+05      1.23e-03
polygon 37               19  3.09221e+04      3.94e-05
polygon 38               37  1.29481e+04      1.65e-05
polygon 39               10  6.60195e+03      8.41e-06
polygon 40               30  4.28933e+03      5.47e-06
polygon 41                4  9.47108e+01      1.21e-07
polygon 42             1045  4.44510e+06      5.66e-03
polygon 43 (hole)        13 -3.91907e+02     -4.99e-07
polygon 44              232  4.72886e+05      6.03e-04
polygon 45               15  4.03300e+04      5.14e-05
polygon 46               14  5.86546e+03      7.47e-06
polygon 47             1020  1.27781e+06      1.63e-03
polygon 48 (hole)         7 -6.28298e-05     -8.01e-14
polygon 49 (hole)         3 -3.23305e-04     -4.12e-13
polygon 50 (hole)         3 -1.20875e-01     -1.54e-10
polygon 51 (hole)        12 -5.81913e-01     -7.41e-10
polygon 52 (hole)         4 -6.55702e-01     -8.36e-10
polygon 53              211  4.70521e+05      6.00e-04
polygon 54              155  2.67502e+05      3.41e-04
polygon 55              129  9.53761e+04      1.22e-04
polygon 56               94  5.96187e+04      7.60e-05
polygon 57               59  3.43150e+04      4.37e-05
polygon 58               10  4.90942e+02      6.26e-07
polygon 59                6  4.50259e+02      5.74e-07
polygon 60                4  2.69313e+02      3.43e-07
polygon 61             1432  4.87153e+06      6.21e-03
polygon 62 (hole)         4 -1.72650e-04     -2.20e-13
polygon 63 (hole)         3 -2.33435e-03     -2.97e-12
polygon 64 (hole)         3 -1.37223e-02     -1.75e-11
polygon 65 (hole)        11 -8.36705e+01     -1.07e-07
polygon 66               75  1.73526e+04      2.21e-05
polygon 67               40  1.38607e+04      1.77e-05
polygon 68               83  5.28920e+03      6.74e-06
polygon 69              139  3.22293e+03      4.11e-06
polygon 70              148  3.10395e+03      3.96e-06
polygon 71              106  3.04104e+03      3.88e-06
polygon 72               45  2.51218e+03      3.20e-06
polygon 73              442  3.45157e+06      4.40e-03
polygon 74               84  1.03238e+05      1.32e-04
polygon 75              102  1.12730e+06      1.44e-03
polygon 76             1179  2.69866e+06      3.44e-03
polygon 77               88  5.33463e+05      6.80e-04
polygon 78               95  1.45519e+05      1.85e-04
polygon 79               55  6.35704e+05      8.10e-04
polygon 80               53  2.76827e+05      3.53e-04
polygon 81              114  6.36650e+04      8.11e-05
polygon 82               83  1.96620e+05      2.51e-04
polygon 83               33  3.65333e+05      4.66e-04
polygon 84              110  1.45503e+06      1.85e-03
polygon 85              135  8.53207e+05      1.09e-03
polygon 86              196  1.07072e+06      1.36e-03
polygon 87               47  5.33013e+05      6.79e-04
polygon 88              130  2.80175e+05      3.57e-04
polygon 89              141  2.14250e+05      2.73e-04
polygon 90               83  1.73122e+05      2.21e-04
polygon 91              192  5.91779e+05      7.54e-04
polygon 92              174  1.75348e+06      2.23e-03
polygon 93              193  3.40743e+05      4.34e-04
polygon 94               59  3.10534e+05      3.96e-04
polygon 95              114  1.38034e+06      1.76e-03
polygon 96              134  1.95176e+06      2.49e-03
polygon 97              270  4.51538e+05      5.75e-04
polygon 98               80  6.97502e+05      8.89e-04
polygon 99              124  1.72655e+05      2.20e-04
polygon 100             277  1.09783e+06      1.40e-03
polygon 101             137  1.05800e+06      1.35e-03
polygon 102             313  2.79680e+06      3.56e-03
polygon 103             496  3.05099e+06      3.89e-03
polygon 104             139  3.36221e+05      4.28e-04
polygon 105              62  7.42203e+05      9.46e-04
polygon 106             226  1.82685e+06      2.33e-03
polygon 107              56  2.93695e+05      3.74e-04
polygon 108             256  5.57276e+05      7.10e-04
polygon 109              48  5.56813e+04      7.10e-05
polygon 110              60  1.16330e+05      1.48e-04
polygon 111             352  2.00345e+06      2.55e-03
polygon 112             129  2.43459e+06      3.10e-03
polygon 113             114  1.07899e+06      1.37e-03
polygon 114             322  4.60550e+05      5.87e-04
polygon 115             198  5.43484e+05      6.93e-04
polygon 116              51  2.78304e+05      3.55e-04
polygon 117             694  1.77060e+06      2.26e-03
polygon 118             297  8.86955e+05      1.13e-03
polygon 119             182  2.18808e+05      2.79e-04
polygon 120             219  3.29438e+05      4.20e-04
polygon 121              88  1.70664e+05      2.17e-04
polygon 122             218  1.34616e+06      1.72e-03
polygon 123              27  1.71334e+05      2.18e-04
polygon 124              84  4.96260e+04      6.32e-05
polygon 125             199  1.93992e+05      2.47e-04
polygon 126              77  1.20171e+05      1.53e-04
polygon 127             108  1.02656e+06      1.31e-03
polygon 128             130  2.00787e+05      2.56e-04
polygon 129             169  7.10569e+05      9.05e-04
polygon 130              34  7.48684e+05      9.54e-04
polygon 131             173  3.68483e+05      4.70e-04
polygon 132             298  7.60621e+06      9.69e-03
polygon 133             239  2.21998e+05      2.83e-04
polygon 134              75  1.26341e+06      1.61e-03
polygon 135              50  3.69771e+05      4.71e-04
polygon 136              83  3.20366e+06      4.08e-03
polygon 137              96  1.10727e+06      1.41e-03
polygon 138              43  5.54624e+05      7.07e-04
polygon 139             126  3.38724e+06      4.32e-03
polygon 140              94  1.87800e+06      2.39e-03
polygon 141              40  8.67750e+05      1.11e-03
polygon 142              55  6.39144e+05      8.14e-04
polygon 143              39  3.26015e+06      4.15e-03
polygon 144              54  4.11404e+05      5.24e-04
polygon 145              75  4.18657e+05      5.33e-04
polygon 146             104  2.09818e+06      2.67e-03
polygon 147              91  1.52455e+06      1.94e-03
polygon 148              74  2.18107e+05      2.78e-04
polygon 149             105  2.13519e+05      2.72e-04
polygon 150             215  2.47266e+06      3.15e-03
polygon 151 (hole)       38 -7.79904e+03     -9.94e-06
polygon 152               4  1.41753e-02      1.81e-11
polygon 153              58  3.16882e+05      4.04e-04
polygon 154              94  1.04642e+06      1.33e-03
polygon 155              63  9.21431e+05      1.17e-03
polygon 156              57  2.39334e+06      3.05e-03
polygon 157             608  1.94141e+06      2.47e-03
polygon 158             325  2.12118e+06      2.70e-03
polygon 159             119  4.85572e+05      6.19e-04
polygon 160             102  7.56926e+05      9.65e-04
polygon 161             111  4.29714e+06      5.48e-03
polygon 162             110  9.91057e+05      1.26e-03
polygon 163             383  2.03851e+06      2.60e-03
polygon 164             125  2.57843e+06      3.29e-03
polygon 165              91  3.18758e+06      4.06e-03
polygon 166              35  2.56100e+06      3.26e-03
polygon 167             112  7.35502e+05      9.37e-04
polygon 168             118  3.51305e+05      4.48e-04
polygon 169              69  1.31292e+06      1.67e-03
polygon 170              67  9.47453e+05      1.21e-03
polygon 171             100  7.49199e+05      9.55e-04
polygon 172              93  1.05203e+06      1.34e-03
polygon 173              92  4.10939e+05      5.24e-04
polygon 174              72  8.39679e+05      1.07e-03
polygon 175             184  1.22706e+06      1.56e-03
polygon 176             120  5.58761e+05      7.12e-04
polygon 177             212  2.09609e+06      2.67e-03
polygon 178              88  7.22589e+05      9.21e-04
polygon 179             281  2.55046e+06      3.25e-03
polygon 180              34  2.04263e+06      2.60e-03
polygon 181              70  3.26040e+06      4.15e-03
polygon 182             119  2.15829e+06      2.75e-03
polygon 183             140  1.34746e+06      1.72e-03
polygon 184              60  2.33891e+06      2.98e-03
polygon 185             154  1.67537e+05      2.13e-04
polygon 186              81  1.16002e+06      1.48e-03
polygon 187              92  2.34938e+06      2.99e-03
polygon 188              86  9.63495e+05      1.23e-03
polygon 189              35  4.85022e+05      6.18e-04
polygon 190              82  1.88131e+06      2.40e-03
polygon 191             103  1.42508e+06      1.82e-03
polygon 192              60  2.38728e+06      3.04e-03
polygon 193              74  1.22989e+06      1.57e-03
polygon 194             123  9.63925e+05      1.23e-03
polygon 195             182  2.77330e+06      3.53e-03
polygon 196             131  3.46851e+06      4.42e-03
polygon 197             452  7.65582e+06      9.76e-03
polygon 198             124  9.48159e+05      1.21e-03
polygon 199             132  1.31911e+06      1.68e-03
polygon 200              60  2.99731e+06      3.82e-03
polygon 201             237  1.97413e+06      2.52e-03
polygon 202             132  1.77073e+06      2.26e-03
polygon 203             210  1.78725e+05      2.28e-04
polygon 204              91  1.49663e+04      1.91e-05
polygon 205              71  8.18750e+03      1.04e-05
polygon 206              84  2.25924e+06      2.88e-03
polygon 207              58  8.59179e+05      1.09e-03
polygon 208              71  1.94861e+06      2.48e-03
polygon 209              87  1.07862e+06      1.37e-03
polygon 210             151  3.02315e+06      3.85e-03
polygon 211              35  4.41733e+05      5.63e-04
polygon 212              60  9.72128e+05      1.24e-03
polygon 213              94  1.23590e+06      1.57e-03
polygon 214             101  1.63984e+06      2.09e-03
polygon 215             107  2.54311e+06      3.24e-03
polygon 216              83  9.55710e+05      1.22e-03
polygon 217             165  8.94516e+05      1.14e-03
polygon 218              76  9.11208e+05      1.16e-03
polygon 219              43  1.14381e+06      1.46e-03
polygon 220             122  1.37683e+06      1.75e-03
polygon 221             129  1.92662e+06      2.45e-03
polygon 222             374  4.13716e+06      5.27e-03
polygon 223              79  1.06189e+06      1.35e-03
polygon 224              75  1.79446e+06      2.29e-03
polygon 225             101  3.47525e+06      4.43e-03
polygon 226              94  1.23166e+06      1.57e-03
polygon 227              52  6.84704e+05      8.72e-04
polygon 228             159  1.08508e+06      1.38e-03
polygon 229              44  1.97494e+06      2.52e-03
polygon 230             141  4.14132e+06      5.28e-03
polygon 231             159  4.34375e+06      5.53e-03
polygon 232              59  1.51553e+06      1.93e-03
polygon 233              60  9.44998e+05      1.20e-03
polygon 234             191  1.99363e+06      2.54e-03
polygon 235             113  2.07797e+06      2.65e-03
polygon 236             136  3.14493e+06      4.01e-03
polygon 237             195  2.63648e+06      3.36e-03
polygon 238              80  1.05717e+06      1.35e-03
polygon 239              56  1.28795e+06      1.64e-03
polygon 240              69  4.39647e+05      5.60e-04
polygon 241              50  7.46882e+05      9.52e-04
polygon 242             108  2.77750e+06      3.54e-03
polygon 243              40  9.06317e+05      1.15e-03
polygon 244              41  3.80202e+05      4.84e-04
polygon 245              82  5.27472e+05      6.72e-04
polygon 246              77  8.00299e+05      1.02e-03
polygon 247             147  8.98555e+05      1.14e-03
polygon 248             154  1.79616e+06      2.29e-03
polygon 249             130  2.25124e+06      2.87e-03
polygon 250             125  7.76142e+05      9.89e-04
polygon 251              61  4.46242e+05      5.69e-04
polygon 252              72  5.72502e+05      7.30e-04
polygon 253              79  8.13383e+05      1.04e-03
polygon 254              94  1.48430e+06      1.89e-03
polygon 255             342  1.97707e+06      2.52e-03
polygon 256              97  1.03728e+06      1.32e-03
polygon 257             167  2.82095e+06      3.59e-03
polygon 258              56  9.24763e+05      1.18e-03
polygon 259             119  1.80638e+06      2.30e-03
polygon 260              64  1.40454e+06      1.79e-03
polygon 261              91  2.37933e+06      3.03e-03
polygon 262             318  8.50229e+06      1.08e-02
polygon 263 (hole)      317 -5.11280e+04     -6.51e-05
polygon 264             368  1.37341e+06      1.75e-03
polygon 265              67  1.43138e+05      1.82e-04
polygon 266              64  4.36369e+05      5.56e-04
polygon 267             127  1.51149e+06      1.93e-03
polygon 268             152  2.45625e+06      3.13e-03
polygon 269              80  1.28721e+06      1.64e-03
polygon 270              32  8.42668e+05      1.07e-03
polygon 271              61  1.33353e+06      1.70e-03
polygon 272              50  1.00741e+06      1.28e-03
polygon 273             235  4.80393e+06      6.12e-03
polygon 274             245  4.70675e+05      6.00e-04
polygon 275              95  1.32888e+06      1.69e-03
polygon 276             114  6.01727e+05      7.67e-04
polygon 277              66  7.63183e+05      9.72e-04
polygon 278              68  9.24866e+05      1.18e-03
polygon 279              55  8.62737e+05      1.10e-03
polygon 280             105  1.58344e+06      2.02e-03
polygon 281              43  8.46137e+05      1.08e-03
polygon 282             256  9.97938e+05      1.27e-03
polygon 283              59  1.46053e+06      1.86e-03
polygon 284              47  1.49668e+06      1.91e-03
polygon 285             153  1.66709e+06      2.12e-03
polygon 286              81  2.39163e+06      3.05e-03
polygon 287              52  1.37871e+06      1.76e-03
polygon 288             100  9.23215e+05      1.18e-03
polygon 289             246  5.32542e+06      6.79e-03
polygon 290             122  1.74439e+06      2.22e-03
polygon 291              76  1.00320e+06      1.28e-03
polygon 292              68  1.09569e+06      1.40e-03
polygon 293              53  6.68454e+05      8.52e-04
polygon 294              69  6.24878e+05      7.96e-04
polygon 295              85  6.74992e+05      8.60e-04
polygon 296             123  2.33068e+06      2.97e-03
polygon 297              68  1.09321e+06      1.39e-03
polygon 298              83  1.86187e+06      2.37e-03
polygon 299              45  9.09419e+05      1.16e-03
polygon 300             102  2.10616e+06      2.68e-03
polygon 301             204  3.33419e+06      4.25e-03
polygon 302             285  1.71970e+06      2.19e-03
polygon 303              87  1.08864e+06      1.39e-03
polygon 304              81  1.56903e+06      2.00e-03
polygon 305              83  1.46451e+06      1.87e-03
polygon 306             105  2.20631e+06      2.81e-03
polygon 307             107  1.18013e+06      1.50e-03
polygon 308             174  1.79346e+06      2.29e-03
polygon 309             112  3.91607e+06      4.99e-03
polygon 310             148  2.17538e+06      2.77e-03
polygon 311             141  3.62301e+06      4.62e-03
polygon 312              80  1.43291e+06      1.83e-03
polygon 313             114  4.38842e+06      5.59e-03
polygon 314             162  1.20044e+06      1.53e-03
polygon 315             128  1.34017e+06      1.71e-03
polygon 316             263  3.28413e+06      4.18e-03
polygon 317             118  2.55346e+06      3.25e-03
polygon 318              49  9.61422e+05      1.23e-03
polygon 319             112  1.28130e+06      1.63e-03
polygon 320              26  7.58123e+05      9.66e-04
polygon 321              76  9.05921e+05      1.15e-03
polygon 322             100  1.41803e+06      1.81e-03
polygon 323              50  1.48925e+06      1.90e-03
polygon 324             117  5.18613e+06      6.61e-03
polygon 325              71  2.35997e+05      3.01e-04
polygon 326             265  5.86424e+06      7.47e-03
polygon 327             103  4.47203e+06      5.70e-03
polygon 328              75  5.00139e+05      6.37e-04
polygon 329              86  6.97637e+05      8.89e-04
polygon 330             306  1.13095e+06      1.44e-03
polygon 331              86  1.45916e+06      1.86e-03
polygon 332              42  7.84712e+05      1.00e-03
polygon 333              68  1.04642e+06      1.33e-03
polygon 334              59  8.99103e+05      1.15e-03
polygon 335              28  7.80760e+05      9.95e-04
polygon 336             323  4.82857e+05      6.15e-04
polygon 337             535  2.45095e+06      3.12e-03
polygon 338              77  2.20921e+06      2.82e-03
polygon 339              79  1.26204e+06      1.61e-03
polygon 340              40  1.25241e+06      1.60e-03
polygon 341             779  3.71587e+07      4.73e-02
polygon 342             125  1.54073e+06      1.96e-03
polygon 343             378  1.63581e+06      2.08e-03
polygon 344             361  2.24122e+06      2.86e-03
polygon 345             667  3.56692e+07      4.55e-02
polygon 346              97  9.13524e+04      1.16e-04
polygon 347             128  1.71195e+06      2.18e-03
polygon 348             163  2.96147e+06      3.77e-03
polygon 349             130  1.25974e+06      1.61e-03
polygon 350               3  6.44872e-01      8.22e-10
polygon 351             112  3.29141e+06      4.19e-03
polygon 352             102  1.57600e+06      2.01e-03
polygon 353             124  1.66419e+06      2.12e-03
polygon 354              94  1.76925e+06      2.25e-03
polygon 355            1954  6.85075e+07      8.73e-02
polygon 356              30  2.80002e+04      3.57e-05
polygon 357              27  1.50315e+04      1.92e-05
polygon 358             103  2.05005e+06      2.61e-03
polygon 359             285  1.61128e+06      2.05e-03
polygon 360              66  1.26165e+06      1.61e-03
polygon 361            1633  1.74954e+07      2.23e-02
polygon 362             164  3.45046e+06      4.40e-03
polygon 363              65  1.74336e+06      2.22e-03
polygon 364              73  1.39448e+06      1.78e-03
polygon 365             141  1.07438e+06      1.37e-03
polygon 366             129  1.51777e+06      1.93e-03
polygon 367             117  5.95652e+05      7.59e-04
polygon 368             719  5.40368e+07      6.89e-02
polygon 369             709  1.28815e+07      1.64e-02
polygon 370              77  3.29939e+05      4.20e-04
polygon 371              44  2.26577e+03      2.89e-06
polygon 372             193  2.14708e+06      2.74e-03
polygon 373              90  1.51100e+06      1.93e-03
polygon 374             125  9.36416e+05      1.19e-03
polygon 375             148  1.64863e+06      2.10e-03
polygon 376             102  1.09939e+06      1.40e-03
polygon 377             158  3.65203e+06      4.65e-03
polygon 378             373  7.05426e+06      8.99e-03
polygon 379             209  7.23576e+06      9.22e-03
polygon 380             103  2.20675e+06      2.81e-03
polygon 381             269  3.84951e+06      4.91e-03
polygon 382             103  6.87914e+05      8.77e-04
polygon 383              75  5.46394e+05      6.96e-04
polygon 384             103  1.96414e+06      2.50e-03
polygon 385             734  2.77044e+07      3.53e-02
polygon 386              71  5.63061e+03      7.17e-06
polygon 387              10  1.99717e+02      2.54e-07
enclosing rectangle: [2667.54, 56396.44] x [15748.72, 50256.33] units
                     (53730 x 34510 units)
Window area = 784784000 square units
Fraction of frame area: 0.423</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#islandSG_ppp_grab0 = grab0_ppp[sg_owin]</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(islandSG_ppp_grab0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(islandSG_ppp_grab0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="kernel-density-estimation" class="level1">
<h1>4.0 Kernel Density Estimation</h1>
<section id="computing-kernel-density-estimation-using-automatic-bandwidth-selection-method" class="level2">
<h2 class="anchored" data-anchor-id="computing-kernel-density-estimation-using-automatic-bandwidth-selection-method">4.1 Computing kernel density estimation using automatic bandwidth selection method</h2>
<p>The code chunk below computes a kernel density by using the following configurations of density() of spatstat:</p>
<ul>
<li><p><a href="https://rdrr.io/cran/spatstat/man/bw.diggle.html"><em>bw.diggle()</em></a> automatic bandwidth selection method. Other recommended methods are <a href="https://rdrr.io/cran/spatstat/man/bw.CvL.html"><em>bw.CvL()</em></a>, <a href="https://rdrr.io/cran/spatstat/man/bw.scott.html"><em>bw.scott()</em></a> or <a href="https://rdrr.io/cran/spatstat/man/bw.ppl.html"><em>bw.ppl()</em></a>.</p></li>
<li><p>The smoothing kernel used is <em>gaussian</em>, which is the default. Other smoothing methods are: “epanechnikov”, “quartic” or “disc”.</p></li>
<li><p>The intensity estimate is corrected for edge effect bias by using method described by Jones (1993) and Diggle (2010, equation 18.9). The default is <em>FALSE</em>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>kde_roadSG_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(road_ppp,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">kernel=</span><span class="st">"gaussian"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_roadSG_bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">bw.diggle</span>(road_ppp)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>bw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sigma 
1.224168 </code></pre>
</div>
</div>
</section>
<section id="rescalling-kde-values" class="level2">
<h2 class="anchored" data-anchor-id="rescalling-kde-values">4.2 Rescalling KDE values</h2>
<p>In the code chunk below, rescale() is used to covert the unit of measurement from meter to kilometer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>road_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(road_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>kde_roadSG.bw <span class="ot">&lt;-</span> <span class="fu">density</span>(road_ppp.km, <span class="at">sigma=</span>bw.diggle, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_roadSG.bw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="working-with-different-automatic-badwidth-methods" class="level2">
<h2 class="anchored" data-anchor-id="working-with-different-automatic-badwidth-methods">4.3 Working with different automatic badwidth methods</h2>
<p>Beside bw.diggle(), there are three other <strong>spatstat</strong> functions can be used to determine the bandwidth, they are: bw.CvL(), bw.scott(), and bw.ppl().</p>
<p>Let us take a look at the bandwidth return by these automatic bandwidth calculation methods by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bw.CvL(road_ppp.km)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bw.scott</span>(road_ppp.km)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> sigma.x  sigma.y 
1.090330 0.634362 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bw.ppl(road_ppp.km)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bw.diggle</span>(road_ppp.km)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      sigma 
0.001224168 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>kde_roadSG.scott <span class="ot">&lt;-</span> <span class="fu">density</span>(road_ppp.km, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sigma=</span>bw.scott, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_roadSG.bw, <span class="at">main =</span> <span class="st">"bw.diggle"</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_roadSG.scott, <span class="at">main =</span> <span class="st">"bw.scott"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="working-with-different-kernel-methods" class="level2">
<h2 class="anchored" data-anchor-id="working-with-different-kernel-methods">4.4 Working with different kernel methods</h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>